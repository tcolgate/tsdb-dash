<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer-ajax/polymer-ajax.html">
<link rel="import" href="dash-dtrange.html">
<link rel="import" href="dash-tsdb-plotset.html" result="{{htree}}">
<link rel="import" href="dash-tsdb-plot.html">
<link rel="import" href="dash-spec.html">

<script src="dash-view-host.js"></script>
<polymer-element name="dash-view-host" attributes="host data groups">
  <template>
    <template if="{{ host == undefined }}">
      <H1>No host set!</h1>
    </template>
    <template if="{{ host != undefined }}">
      <H1>Host view: {{host}}</h1>
      <dash-dtrange id="dtinput" start={{start_time}} end={{end_time}}></dash-dtrange>
      <p>

      <polymer-ajax auto url="groupings.json" 
        handleAs="json"
        on-polymer-response="{{gotGroups}}">
      </polymer-ajax>

      <dash-tsdb-tree id="hosttree" tree_id=1 result="{{htree}}"></dash-tsdb-tree>
      <template repeat="{{ t in htree.leaves }}">
        <h3> {{ t }} </h3>
      </template>

      <template repeat="{{ g in groups }}">
        <h3> {{ g.name }} </h3>
      </template>

      <dash-spec
          specName="net_bytes"
         globaltags="{{ tags }}"
               spec="{{ spec }}">
      </dash-spec>

      <template if="{{ spec != undefined }}">
        <h3> </h3>
        <dash-tsdb-plotset 
            width=600,
           height=300,
             spec={{spec}}
            start={{start_time}}
              end={{end_time}}
          results={{data}}>
        </dash-tsdb-plotset>

        <template if="{{ data != undefined }}">
          <template repeat="{{ d in data }}">
            <dash-tsdb-plot 
                style="float: left;"
                spec={{spec}}
                name={{d.name}}
                data={{d.data}}
               width=500
               height=300
               on-plot-select="{{ plotSelected }}">
            </dash-tsdb-plot>
          </template>
        </template>
      </template>
    </template>
  </template>
</polymer-element>
