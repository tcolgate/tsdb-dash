<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer-ajax/polymer-ajax.html">
<link rel="import" href="../elements/dash-tsdb-tree.html">

<polymer-element name="dash-app">
  <template>
    <H1>TSDB Dasboard</h1>

    <polymer-ajax auto url="/api/tree" 
      handleAs="json"
      on-polymer-response="{{gotTrees}}">
    </polymer-ajax>

    <polymer-ajax auto url="groupings.json" 
      handleAs="json"
      on-polymer-response="{{gotGroups}}">
    </polymer-ajax>

    <template repeat="{{ tree in trees }}">
      <dash-tsdb-tree tree_id={{tree.treeId}}></dash-tsdb-tree>
    </template>

  </template>
  <script>
    Polymer('dash-app', {
        trees: [],
       groups: [],
     gotTrees: function(ev,resp){
                 this.trees = resp.response;
                 console.log(this.trees);
               },
    gotGroups: function(ev,resp){
                 this.groups = resp;
               },
        ready: function(){
               }
    });
  </script>
</polymer-element>
